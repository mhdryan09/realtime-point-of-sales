# 8. Dropdown Action

## Recap Perubahan

### 1. Membuat Dropdown Action Component

**Langkah:**
Membuat reusable dropdown action component di `src/components/common/dropdown-action.tsx`:

```typescript
import { ReactNode } from "react";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "../ui/dropdown-menu";
import { Button } from "../ui/button";
import { EllipsisVertical } from "lucide-react";

type menuProps = {
  menu: {
    label: string | ReactNode;
    variant?: "destructive" | "default";
    action?: () => void;
    type?: "button" | "link";
  }[];
};

export default function DropdownAction({ menu }: menuProps) {
  return (
    <DropdownMenu>
      <DropdownMenuTrigger>
        <Button
          variant="ghost"
          className="text-muted-foreground size-8"
          size="icon"
        >
          <EllipsisVertical />
        </Button>
      </DropdownMenuTrigger>

      <DropdownMenuContent align="end" className="w-32">
        {menu.map((item, index) => (
          <DropdownMenuItem
            key={`dropdown-action-${index}`}
            variant={item.variant || "default"}
            asChild={item.type === "link"}
            onClick={item.action}
          >
            {item.label}
          </DropdownMenuItem>
        ))}
      </DropdownMenuContent>
    </DropdownMenu>
  );
}
```

**Penjelasan:**

- **Reusable Component**: Component dropdown yang bisa digunakan untuk berbagai action buttons
- **Three Dots Icon**: Menggunakan EllipsisVertical icon untuk trigger button
- **Dynamic Menu**: Menu items dibuat berdasarkan array yang dikirim via props
- **Flexible Props**: Support string atau React component untuk label
- **Action Handling**: Setiap menu item bisa memiliki onClick action
- **Variant Support**: Support different variants seperti destructive untuk delete action

#### **Penjelasan Script Kompleks:**

**1. TypeScript Interface:**

```typescript
type menuProps = {
  menu: {
    label: string | ReactNode;
    variant?: "destructive" | "default";
    action?: () => void;
    type?: "button" | "link";
  }[];
};
```

- `menu`: Array of menu items
- `label: string | ReactNode`: Label bisa berupa text atau React component (icon + text)
- `variant?: "destructive" | "default"`: Optional variant untuk styling (red untuk delete)
- `action?: () => void`: Optional callback function yang dipanggil saat item diklik
- `type?: "button" | "link"`: Optional type untuk button atau link behavior
- **Optional Properties**: Tanda `?` berarti property tidak wajib diisi

**2. Trigger Button Pattern:**

```typescript
<DropdownMenuTrigger>
  <Button
    variant="ghost"
    className="text-muted-foreground size-8"
    size="icon"
  >
    <EllipsisVertical />
  </Button>
</DropdownMenuTrigger>
```

- `variant="ghost"`: Button tanpa background untuk subtle appearance
- `size="icon"`: Square button untuk icon-only
- `size-8`: Width dan height 2rem (32px)
- `text-muted-foreground`: Warna text yang subtle/muted
- **EllipsisVertical**: Three dots vertical icon (⋮) sebagai universal action indicator

**3. Dynamic Menu Rendering:**

```typescript
{menu.map((item, index) => (
  <DropdownMenuItem
    key={`dropdown-action-${index}`}
    variant={item.variant || "default"}
    asChild={item.type === "link"}
    onClick={item.action}
  >
    {item.label}
  </DropdownMenuItem>
))}
```

- **Array Mapping**: Loop through menu array untuk render semua items
- `variant={item.variant || "default"}`: Gunakan variant dari props atau default
- `asChild={item.type === "link"}`: Boolean untuk render as child (untuk Next.js Link)
- `onClick={item.action}`: Attach action function ke onClick event
- **Flexible Label**: Bisa render string atau React component

**4. Content Positioning:**

```typescript
<DropdownMenuContent align="end" className="w-32">
```

- `align="end"`: Align dropdown ke kanan trigger button
- `w-32`: Width 8rem (128px) untuk consistent dropdown width
- **Portal Rendering**: Radix UI otomatis render dropdown di body untuk avoid overflow issues

### 2. Integrasi Dropdown Action ke User Table

**Langkah:**
Mengintegrasikan DropdownAction ke user management table di `src/app/(dashboard)/admin/user/_components/user.tsx`:

```typescript
"use client";

import DropdownAction from "@/components/common/dropdown-action";
import { Pencil, Trash2 } from "lucide-react";

export default function UserManagement() {
  // ... existing code

  const filteredData = useMemo(() => {
    return (users || []).map((user, index) => {
      return [
        index + 1,
        user.id,
        user.name,
        user.role,
        <DropdownAction
          key={user.id}
          menu={[
            // button edit
            {
              label: (
                <span className="flex items-center gap-2">
                  <Pencil />
                  Edit
                </span>
              ),
              action: () => {},
            },
            // button delete
            {
              label: (
                <span className="flex items-center gap-2">
                  <Trash2 className="text-red-400" />
                  Delete
                </span>
              ),
              variant: "destructive",
              action: () => {},
            },
          ]}
        />,
      ];
    });
  }, [users]);

  // ... rest of code
}
```

**Perubahan yang dilakukan:**

- ✅ **Import Component**: Import DropdownAction dan icons dari lucide-react
- ✅ **Replace Empty String**: Ganti placeholder "" dengan DropdownAction component
- ✅ **Add Edit Menu**: Menu item untuk edit action dengan Pencil icon
- ✅ **Add Delete Menu**: Menu item untuk delete action dengan Trash2 icon dan red color
- ✅ **JSX in Array**: Menggunakan React component sebagai array element

#### **Penjelasan Script Kompleks:**

**1. React Component in Data Array:**

```typescript
<DropdownAction
  key={user.id}
  menu={[...]}
/>
```

- **JSX in Array**: TypeScript/React membolehkan React component di dalam array
- `key={user.id}`: Unique key untuk React reconciliation
- **Component as Data**: DataTable menerima `(string | ReactNode)[][]` jadi bisa terima component

**2. Menu Configuration Pattern:**

```typescript
menu={[
  {
    label: (
      <span className="flex items-center gap-2">
        <Pencil />
        Edit
      </span>
    ),
    action: () => {},
  },
  {
    label: (
      <span className="flex items-center gap-2">
        <Trash2 className="text-red-400" />
        Delete
      </span>
    ),
    variant: "destructive",
    action: () => {},
  },
]}
```

- **JSX Label**: Label menggunakan JSX untuk kombinasi icon + text
- **Flexbox Layout**: `flex items-center gap-2` untuk horizontal layout dengan spacing
- **Icon Styling**: `text-red-400` untuk red color pada delete icon
- **Variant**: `destructive` untuk red background hover effect
- **Placeholder Actions**: `() => {}` empty function sebagai placeholder (akan diisi nanti)

---

**Kesimpulan:**
Perubahan ini menambahkan dropdown action button yang reusable untuk action buttons di table. User management table sekarang memiliki edit dan delete buttons yang accessible melalui three dots dropdown menu, dengan styling yang konsisten dan user-friendly.

---

_Catatan: Dropdown action component ini mengikuti pattern yang umum digunakan di aplikasi modern, membuat UI lebih clean dan space-efficient dibanding multiple buttons per row._
